<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="Русский">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Work+Sans:500,600" rel="stylesheet">
  
    <title>Customizing the web client &mdash; Перевод на русский язык документации Odoo 11.0</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <script type="text/javascript" src="https://yastatic.net/es5-shims/0.0.2/es5-shims.min.js"></script>
    <script type="text/javascript" src="https://yastatic.net/share2/share.js"></script>
    <link rel="top" title="Перевод на русский язык документации Odoo 11.0" href="../index.html" />
    <link rel="up" title="Учебные пособия" href="../tutorials.html" />
    <link rel="next" title="Profiling Odoo code" href="profilecode.html" />
    <link rel="prev" title="Создание модуля" href="backend.html" /> 
  </head>
  <body role="document"><header class="o_main_header o_has_sub_nav o_inverted ">
  <div class="o_main_header_main">
    <a class="pull-left o_logo" href="/"></a>
    <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
      <span class="sr-only">Toggle navigation</span>
      <span class="mdi-navigation-menu"></span>
    </a>
    <ul class="o_primary_nav">
      <li><a href="/">Документация</a></li>
    </ul>
  </div>
  <nav class="navbar o_sub_nav">
    <div class="container">
      <div class="navbar-header visible-xs">
          <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
            Меню
            <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
          </button>
      </div>

      <div class="collapse navbar-collapse" id="o_sub-menu">
        <ol class="o_breadcrumb breadcrumb nav navbar-left">
            
            
            





    
        
            <li><a href="../index.html">Документация  (11.0)</a></li>
        
    
    <li class="active"><a href="#">Customizing the web client</a></li>

            
        </ol>

        <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
          
            <li class="divider"></li>
          

          
          
<li class="languages dropdown">
    <a class="dropdown-toggle" href="#" data-toggle="dropdown">
        Русский
    </a>
    <ul class="dropdown-menu" role="menu">
        
            <li><a href="/developer/11.0/en/howtos/web.html">English</a></li>
        
    </ul>
</li>



<li class="versions dropdown">
    <a class="dropdown-toggle" href="#" data-toggle="dropdown">
        11.0
    </a>
    <ul class="dropdown-menu" role="menu">
        
            <li><a href="/developer/8.0/ru/howtos/web.html">8.0</a></li>
        
            <li><a href="/developer/9.0/ru/howtos/web.html">9.0</a></li>
        
            <li><a href="/developer/10.0/ru/howtos/web.html">10.0</a></li>
        
    </ul>
</li>

          
        </ul>

        <ul class="nav navbar-nav navbar-right">
          
            <li class="divider"></li>
          

          
          

<li><a href="/user/11.0/ru/">Пользователю</a></li>
<li><a href="/developer/11.0/ru/">Разработчику</a></li>
<li><a href="/developer/11.0/ru/api_integration.html">API</a></li>
<li><a href="/developer/11.0/ru/setup/install.html">Установка</a></li>
<li><a href="/developer/11.0/ru/python3.html">Python 3</a></li>
          

          
            <li class="divider"></li>
          
        </ul>
      </div>
    </div>
  </nav>
</header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/build_interface_ext.jpg');"></span>
      <div class="container text-center">
        <h1> Customizing the web client - Odoo 11.0 </h1>
      </div>
    </figure>
    
    
    
      <main class="container ">
        
        <div class="o_content row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="list-group text-left nav"><li class="list-group-item"><a href="#a-simple-module" class="ripple internal reference">Простой модуль</a></li><li class="list-group-item"><a href="#odoo-javascript-module" class="ripple internal reference">Odoo JavaScript модуль</a></li><li class="list-group-item"><a href="#classes" class="ripple internal reference">Классы</a></li><li class="list-group-item"><a href="#widgets-basics" class="ripple internal reference">Основы работы с Widget</a><ul ><li class="list-group-item"><a href="#your-first-widget" class="ripple internal reference">Ваш первый Widget</a></li><li class="list-group-item"><a href="#display-content" class="ripple internal reference">Отображение контента</a></li><li class="list-group-item"><a href="#widget-parents-and-children" class="ripple internal reference">Родительские и дочерние объекты Widget</a></li><li class="list-group-item"><a href="#destroying-widgets" class="ripple internal reference">Уничтожение виджетов</a></li></ul></li><li class="list-group-item"><a href="#the-qweb-template-engine" class="ripple internal reference">Шаблонизатор QWeb</a><ul ><li class="list-group-item"><a href="#using-qweb" class="ripple internal reference">Использование QWeb</a><ul ><li class="list-group-item"><a href="#qweb-context" class="ripple internal reference">Работа с Context в Qweb</a></li><li class="list-group-item"><a href="#template-declaration" class="ripple internal reference">Объявление шаблона</a></li><li class="list-group-item"><a href="#escaping" class="ripple internal reference">Вывод данных</a></li><li class="list-group-item"><a href="#outputting-html" class="ripple internal reference">Вывод HTML</a></li><li class="list-group-item"><a href="#conditionals" class="ripple internal reference">Условные выражения</a></li><li class="list-group-item"><a href="#iteration" class="ripple internal reference">Перебор значений</a></li><li class="list-group-item"><a href="#defining-attributes" class="ripple internal reference">Определение атрибутов</a></li><li class="list-group-item"><a href="#calling-other-templates" class="ripple internal reference">Вызов других шаблонов</a></li><li class="list-group-item"><a href="#to-learn-more-about-qweb" class="ripple internal reference">Для более глубокого изучения QWeb</a></li><li class="list-group-item"><a href="#exercise" class="ripple internal reference">Упражнение</a></li></ul></li></ul></li><li class="list-group-item"><a href="#widget-helpers" class="ripple internal reference">Помощники для Widget</a><ul ><li class="list-group-item"><a href="#widget-s-jquery-selector" class="ripple internal reference"><code >Widget</code>'s jQuery Selector</a></li><li class="list-group-item"><a href="#easier-dom-events-binding" class="ripple internal reference">Простое связывание DOM событий</a></li></ul></li><li class="list-group-item"><a href="#widget-events-and-properties" class="ripple internal reference">События и свойства Widget</a><ul ><li class="list-group-item"><a href="#events" class="ripple internal reference">События</a></li><li class="list-group-item"><a href="#properties" class="ripple internal reference">Свойства</a></li><li class="list-group-item"><a href="#id3" class="ripple internal reference">Упражнение</a></li></ul></li><li class="list-group-item"><a href="#modify-existing-widgets-and-classes" class="ripple internal reference">Изменение существующих виджетов и классов</a></li><li class="list-group-item"><a href="#translations" class="ripple internal reference">Система переводов на другие языки</a></li><li class="list-group-item"><a href="#communication-with-the-odoo-server" class="ripple internal reference">Связь с сервером Odoo</a><ul ><li class="list-group-item"><a href="#contacting-models" class="ripple internal reference">Взаимодействие с моделями данных</a></li><li class="list-group-item"><a href="#compoundcontext" class="ripple internal reference">CompoundContext - составной контекст</a></li><li class="list-group-item"><a href="#queries" class="ripple internal reference">Запросы</a></li></ul></li><li class="list-group-item"><a href="#exercises" class="ripple internal reference">Упражнения</a></li><li class="list-group-item"><a href="#existing-web-components" class="ripple internal reference">Существующие веб-компоненты</a><ul ><li class="list-group-item"><a href="#the-action-manager" class="ripple internal reference">Менеджер действий</a><ul ><li class="list-group-item"><a href="#using-the-action-manager" class="ripple internal reference">Использование менеджера действий</a></li></ul></li><li class="list-group-item"><a href="#client-actions" class="ripple internal reference">Действия клиента</a></li><li class="list-group-item"><a href="#architecture-of-the-views" class="ripple internal reference">Архитектура представлений</a><ul ><li class="list-group-item"><a href="#the-view-manager" class="ripple internal reference">Менеджер представлений</a></li><li class="list-group-item"><a href="#the-views" class="ripple internal reference">Представления</a></li></ul></li><li class="list-group-item"><a href="#the-form-view-fields" class="ripple internal reference">Поля представлений вида Form</a><ul ><li class="list-group-item"><a href="#creating-a-new-type-of-field" class="ripple internal reference">Создание нового типа поля</a><ul ><li class="list-group-item"><a href="#simple-read-only-field" class="ripple internal reference">Простое поле только для чтения</a></li><li class="list-group-item"><a href="#read-write-field" class="ripple internal reference">Поле для чтения-записи</a></li></ul></li></ul></li><li class="list-group-item"><a href="#the-form-view-custom-widgets" class="ripple internal reference">Пользовательские виджеты для представления вида Form</a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/11.0/doc/howtos/web.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
		  <div class="ya-share2" data-services="collections,vkontakte,facebook,odnoklassniki,moimir,gplus,twitter,linkedin,viber,whatsapp,skype,telegram"></div>
          <article class="doc-body ">
            
            
            
  <section id="customizing-the-web-client"><p >Note: this section is really really out of date. It will be updated someday,
but meanwhile, this tutorial will probably be frustrating to follow, since it
was written a long time ago.</p><p >Это руководство посвящено созданию модулей для веб-клиента Odoo.</p><p >Чтобы создать веб-сайты с помощью Odoo, см. <a href="website.html" class="internal reference"><span class="doc">Создание веб-сайта</span></a>;  того чтобы добавить новые бизнес возможности или расширить существующие в Odoo, см. <a href="backend.html" class="internal reference"><span class="doc">Создание модуля</span></a>.</p><div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p >Данное руководство предполагает следующие знание:</p><ul ><li ><p >Основы и рекомендации по использованию Javascript</p></li><li ><p >jQuery</p></li><li ><a href="http://underscorejs.org" class="external reference alert-link">Underscore.js</a></li></ul><p >Так же требуетсяIt also requires <a href="../setup/install.html#setup-install" class="internal alert-link reference"><span class="std std-ref">установленная Odoo</span></a> и <a href="http://git-scm.com" class="external reference alert-link">Git</a>.</p></div></section><section id="a-simple-module"><h2 >Простой модуль</h2><p >Начнем с простого модуля Odoo, содержащего базовую конфигурацию веб-компонентов и позволяющую протестировать веб-фреймворк.</p><p >Пример модуля доступен онлайн и может быть загружен с помощью следующей команды:</p><div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> git clone http://github.com/odoo/petstore
</pre></div>
</div>
<p >Данное действие создаст папку <code >petstore</code> там где Вы выполнили команду. Далее необходимо добавить этот каталог в <a href="../reference/cmdline.html#cmdoption-odoo-bin--addons-path" class="internal reference"><code class="std xref std-option">addons path</code></a>, создать новую базу данных и установить модуль <code >oepetstore</code>.</p><p >Если вы просмотрите папку <code >petstore</code>, увидите следующие содержимое:</p><div class="highlight-text"><div class="highlight"><pre><span></span>oepetstore
|-- images
|   |-- alligator.jpg
|   |-- ball.jpg
|   |-- crazy_circle.jpg
|   |-- fish.jpg
|   `-- mice.jpg
|-- __init__.py
|-- oepetstore.message_of_the_day.csv
|-- __manifest__.py
|-- petstore_data.xml
|-- petstore.py
|-- petstore.xml
`-- static
    `-- src
        |-- css
        |   `-- petstore.css
        |-- js
        |   `-- petstore.js
        `-- xml
            `-- petstore.xml
</pre></div>
</div>
<p >Модуль уже содержит некоторые изменения серверной части. Мы вернемся к ним позже, а пока давайте сосредоточимся на веб-содержимом в папке <code >static</code>.</p><p >Файлы используемые в &quot;web&quot; части Odoo модуля должны быть помещены в каталог <code >static</code>, для того, чтобы они стали доступны из веб-браузереа файлы, находящиеся вне этого каталога, не могут быть получены браузером напрямую. Подкаталоги <code >src/css</code>, <code >src/js</code> и <code >src/xml</code> не обязаны иметь строго аналогичные названия и имеют такие имена исключительно для удобства разработки.</p><dl ><dt ><code >oepetstore/static/css/petstore.css</code></dt><dd ><p >пока пуст, будет содержать <a href="http://www.w3.org/Style/CSS/Overview.en.html" class="external reference">CSS</a> для контента магазина для животных</p></dd><dt ><code >oepetstore/static/xml/petstore.xml</code></dt><dd ><p >Так же почти пуст, будет содержать <a href="../reference/qweb.html#reference-qweb" class="internal reference"><span class="std std-ref">Qweb</span></a> шаблон</p></dd><dt ><code >oepetstore/static/js/petstore.js</code></dt><dd ><p >Наиболее важная (и интересная) часть содержит логику приложения (или, по крайней мере, его веб-браузерную часть) в виде javascript. Должна выглядеть следующим образом:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pet store home page loaded&quot;</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
        <span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl><p >Этот код выводит небольшое сообщение в консоль веб-браузера.</p><p >Файлы в папке <code >static</code>, должны быть определены внутри модуля, чтобы они были правильно загружены. Все в <code >src/xml</code> определено в <code >__manifest__.py</code> а содержимое <code >src/css</code> и <code >src/js</code> определено в  <code >petstore.xml</code>, или похожий файл.</p><div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p >Все JavaScript файлы объеденены и <a href="../glossary.html#term-minified" class="internal alert-link reference"><span class="std std-term xref">minified</span></a> для снижения времени загрузки приложения.</p><p >Одним из недостатков такого подхода является то, что отладка становится более сложной отдельные файлы исчезают и код становится практически не читаемым. Есть возможность отключить данных процесс путем включения &quot;режима разработчика&quot;: авторизируйтесь в вашей Odoo системе (пользователь <strong >admin</strong> пароль <strong >admin</strong> по умолчанию), откройте меню пользователя (в верхнем правом углу экрана Odoo) И выберите <span class="guilabel">About Odoo</span>, а затем <span class="guilabel">Activate the developer mode</span>:</p><img src="../_images/about_odoo.png" class="img-responsive center-block"><img src="../_images/devmode.png" class="img-responsive center-block"><p >Данный механизм перезагрузит клиент с отключенными механизмами оптимизации, что позволит вести разработку и отладку более комфортно.</p></div></section><section id="odoo-javascript-module"><h2 >Odoo JavaScript модуль</h2><p >Чистый Javascript сам по себе не имеет встроенных модулей. В результате чего переменные определенные в разных файлах могут смешиваться и конфликтовать. Такая ситуация привела к тому, что стали появляться различные шаблоны модулей, использование которых позволяет создавать чистые пространства имен с минимальными рисками конфликтов.</p><p >Odoo использует такого рода шаблоны для определения модулей внутри своих веб расширений, для упорядочивания как пространства имен так и правильного порядка загрузки.</p><p ><code >oepetstore/static/js/petstore.js</code> содержит объявление модуля:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">local</span><span class="p">.</span><span class="nx">xxx</span> <span class="o">=</span> <span class="p">...;</span>
<span class="p">}</span>
</pre></div>
</div>
<p >В Odoo web модули объявляются как функции, установленные в глобальной переменной <code >odoo</code>. Имя функции должно быть таким же, как и addon (в данном случае <code >oepetstore</code>), чтобы инфраструктура могла его найти, и автоматически инициализировать его.</p><p >Когда веб-клиент загружает ваш модуль, он вызывает корневую функцию и предоставляет ей два параметра:</p><ul ><li ><p >Первый параметр является текущим экземпляром веб-клиента Odoo, он предоставляет доступ к различным возможностям, определенным Odoo (переводы, сетевые службы), а также объекты, определенные ядром или другими модулями.</p></li><li ><p >Вторым параметром является ваше собственное локальное пространство имен, автоматически созданное веб-клиентом. Объекты и переменные, которые должны быть доступны извне вашего модуля (либо из-за того что Odoo веб клиенту необходимо вызывать их, либо другие хотят кастомизировать их) должны быть установлены внутри этого пространства имен.</p></li></ul></section><section id="classes"><h2 >Классы</h2><p >В отличие от модулей и вопреки большинству объектно-ориентированных языков, javascript не строит в <em >классах</em> [#classes] _ хотя он предоставляет примерно эквивалентные (более низкоуровневые и более многословные) механизмы.</p><p >Для простоты и удобства разработчиков веб часть Odoo предоставляет систему классов основанную на <a href="http://ejohn.org/blog/simple-javascript-inheritance/" class="external reference">Simple JavaScript Inheritance</a>.</p><p >Новые классы определяются вызовом метода <code class="js-func xref js">extend()</code> из <code class="js-class xref js">odoo.web.Class()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Метод <code class="js-func xref js">extend()</code> принимает словарь, описывающий содержимое нового класса (методы и статические атрибуты). В этом случае у него будет только метод <code >say_hello</code>, который не принимает параметров.</p><p >Классы создаются с помощью оператора <code >new</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello&quot; in the console</span>
</pre></div>
</div>
<p >Доступ к атрибутам экземпляра может быть получен через <code >this</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Bob&quot;</span><span class="p">;</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob&quot; in the console</span>
</pre></div>
</div>
<p >Классы могут предоставлять инициализатор для выполнения первоначальной настройки экземпляра, через определение метода <code >init()</code>. Инициализатор принимает параметры, переданы при использовании оператора <code >new</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob&quot; in the console</span>
</pre></div>
</div>
<p >Также возможно создавать подклассы из существующих (используемых-определенных) классов, вызывая <code class="js-func xref js">extend()</code> в родительском классе, как это делается для подкласса <code class="js-class xref js">Class()</code>::[UNKNOWN NODE problematic]:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hola&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hola Bob&quot; in the console</span>
</pre></div>
</div>
<p >При переопределении метода с использованием наследования вы можете использовать <code >this._super()</code> для вызова исходного метода:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;translation in Spanish: hola&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob \n translation in Spanish: hola Bob&quot; in the console</span>
</pre></div>
</div>
<div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p ><code >_super</code> не является стандартным методом, он устанавливается &quot;на лету&quot; к следующему методу в текущей цепочке наследования, если таковая имеется. Он определяется только во время использования синхронного метода, для вызова в асинхронных обработчиках (после сетевых вызовов или в обратных вызовах <code >setTimeout</code>) ссылку на его значение следует сохранить, к нему нельзя получить доступ через <code >this</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// broken, will generate an error</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// correct</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// don&#39;t forget .bind()</span>
    <span class="kd">var</span> <span class="nx">_super</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></section><section id="widgets-basics"><h2 >Основы работы с Widget</h2><p >Web-клиент Odoo связывает <a href="http://jquery.org" class="external reference">jQuery</a> для легкой манипуляции с DOM. Это полезно и обеспечивает лучший API, чем стандартный <a href="http://www.w3.org/TR/DOM-Level-3-Core/" class="external reference">W3C DOM</a> [#dombugs]_, которого не достаточно для структурирования комплексных приложений, что приводит к сложностям в обслуживании.</p><p >Подобно объектно-ориентированным шаблонизаторам (например, <a href="http://qt-project.org" class="external reference">Qt</a>, <a href="https://developer.apple.com/technologies/mac/cocoa.html" class="external reference">Cocoa</a> или <a href="http://www.gtk.org" class="external reference">GTK</a>), Odoo Web делает конкретные компоненты ответственными за разделы страницы. В Odoo web базой для таких компонентов является класс <code class="js-class xref js">Widget()</code>, специализирующийся на обработке раздела страницы и отображении информации для пользователя.</p></section><section id="your-first-widget"><h3 >Ваш первый Widget</h3><p >В начальном демонстрационном модуле уже есть базовый виджет:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pet store home page loaded&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Он расширяется <code class="js-class xref js">Widget()</code> и переопределяет стандартный метод <code class="js-func xref js">start()</code>, который - как и предыдущий <code >MyClass</code> — пока мало что делает.</p><p >Эта строка в конце файла:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
    <span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p >Регистрирует наш основной виджет как действие клиента. Действия клиента будут объяснены позже, на данный момент это именно то, что позволяет нашему виджету вызываться и отображаться, когда мы выбираем меню <span class="menuselection">Pet Store ‣ Pet Store ‣ Home Page</span>.</p><div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p >Т.к. виджет виджет будет вызываться вне нашего модуля, веб клиенту необходимо его полное имя, а не локальная его версия.</p></div></section><section id="display-content"><h3 >Отображение контента</h3><p >Виджеты имеют ряд методов и функций, но основы просты:</p><ul ><li ><p >настройка виджета</p></li><li ><p >формат данных виджета</p></li><li ><p >отображение виджета</p></li></ul><p >В виджете <code >HomePage</code> уже есть метод <code class="js-func xref js">start()</code>. Этот метод является частью жизненного цикла обычного виджета и автоматически вызывается после добавления виджета на страницу. Мы можем использовать его для отображения некоторого контента.</p><p >Все виджеты имеют атрибут <code class="js-attr xref js">$el</code>, который представляет раздел страницы, за которую они отвечают (как объект <a href="http://jquery.org" class="external reference">jQuery</a>). Содержимое виджета будет помещено внутри. По умолчанию, <code class="js-attr xref js">$el</code> является пустым элементом <code >&lt;div&gt;</code>.</p><p >Элемент <code >&lt;div&gt; `` обычно невидим для пользователя, если внутри нет контента (или нет определенных стилей, придающих ему размер), поэтому при запуске ``HomePage</code> пока на странице ничего не отобразиться.</p><p >Давайте добавим содержимое в корневой элемент виджета, используя jQuery:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Это сообщение появится, когда вы откроете <span class="menuselection">Pet Store ‣ Pet Store ‣ Home Page</span></p><div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >Для обновления кода javascript, загруженного в Odoo Web, вам необходимо перезагрузить страницу. Нет необходимости перезапускать сервер Odoo.</p></div><p >Виджет <code >HomePage</code> используется Odoo Web и управляется автоматически. Чтобы узнать, как работать с виджетами «с нуля», давайте создадим новый:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;We are so happy to see you again in this menu!&lt;/div&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Теперь мы можем добавить наш <code >GreetingsWidget</code> в <code >HomePage</code> с помощью метода <code >GreetingsWidget</code> <code class="js-func xref js">appendTo()</code> method:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<ul ><li ><p ><code >HomePage</code> сначала добавляет свое содержимое в корень DOM</p></li><li ><p >Затем ` HomePage`` создает экземпляр <code >GreetingsWidget</code></p></li><li ><p >И в конце он сообщает <code >GreetingsWidget</code> куда вставлять себя, делегируя часть своего <code class="js-attr xref js">$el</code> <code >GreetingsWidget</code>'у.</p></li></ul><p >Когда вызывается метод <code class="js-func xref js">appendTo()</code>, он просит виджет вставить себя в указанную позицию и отобразить его содержимое. Метод <code class="js-func xref js">start()</code> будет вызываться во время вызова <code class="js-func xref js">appendTo()</code>.</p><p >Чтобы увидеть, что происходит под отображаемым интерфейсом, мы будем использовать DOM Explorer браузера. Но сначала давайте немного изменим наши виджеты, чтобы мы могли легче находить, где они находятся, <code class="js-attr xref js">добавив класс к их корневым элементам</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;oe_petstore_homepage&#39;</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
<span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;oe_petstore_greetings&#39;</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Если вы можете найти соответствующий раздел DOM (щелкните правой кнопкой мыши на странице, затем <span class="guilabel">Inspect Element</span>), он должен выглядеть так:</p><div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;oe_petstore_homepage&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello dear Odoo user!<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;oe_petstore_greetings&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>We are so happy to see you again in this menu!<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p >Здесь четко показаны два элемента <code >&lt;div&gt;</code>, которые автоматически создаются  <code class="js-class xref js">Widget()</code>, потому что мы добавили в них некоторые классы.</p><p >Мы также можем увидеть два прикрепленных к сообщению div'а, которые мы добавили сами.</p><p >Наконец, обратите внимание, что элемент <code >&lt;div class=&quot;oe_petstore_greetings&quot;&gt;</code>, который представляет экземпляр <code >GreetingsWidget</code> находящийся внутри <code >&lt;div class=&quot;oe_petstore_homepage&quot;&gt;</code> предоставленного экземпляра <code >HomePage</code>.</p></section><section id="widget-parents-and-children"><h3 >Родительские и дочерние объекты Widget</h3><p >В предыдущей части мы создали экземпляр виджета, используя этот синтаксис:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
</div>
<p >Первый аргумент - <code >this`, который в этом случае является экземпляром ``HomePage</code>. Это говорит виджету созданному другим виджетом, что он является его родителем.</p><p >Как мы видели, виджеты, как правило, вставляются в DOM другим виджетами, которые будут являться корневым элементом вставляемого виджета. Это означает, что большинство виджетов являются «частью» другого виджета и существуют от его имени. Мы вызываем контейнер <em >parent</em>, а содержащий его виджет <em >child</em>.</p><p >Из-за многочисленных технических и концептуальных причин виджету необходимо знать, кто его родитель и кто его дети.</p><dl ><dt ><code class="js-func xref js">getParent()</code></dt><dd ><p >Может использоваться для получения родителя виджета:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getParent</span><span class="p">().</span><span class="nx">$el</span> <span class="p">);</span>
        <span class="c1">// will print &quot;div.oe_petstore_homepage&quot; in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd><dt ><code class="js-func xref js">getChildren()</code></dt><dd ><p >Может использоваться для получения списка его дочерних объектов:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">$el</span><span class="p">);</span>
        <span class="c1">// will print &quot;div.oe_petstore_greetings&quot; in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd></dl><p >При переопределении метода <code class="js-func xref js">init()</code> виджета <strong >очень важно</strong> передать родительскому элементу вызов  <code >this._super()</code>, иначе подчинение будет установлено неверно:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Наконец, если виджет не имеет родительского объекта (т.к. это корневой виджет приложения), в качестве родителя может быть указан <code >null</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
</section><section id="destroying-widgets"><h3 >Уничтожение виджетов</h3><p >Если вы можете показать контент вашим пользователям, то вы так же должны иметь возможность его удалить. Это достигается с помощью метода <code class="js-func xref js">destroy()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">greeting</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
</div>
<p >Когда виджет уничтожается, он сначала вызывает <code class="js-func xref js">destroy()</code> для всех его потомков. Затем он удаляется из DOM. Если вы создали постоянные структуры в <code class="js-func xref js">init()</code> или <code class="js-func xref js">start()</code>, они должны быть явно очищены (потому что метод удаления не будет их обрабатывать), для этого необходимо переопределить <code class="js-func xref js">destroy()</code>.</p><div role="alert" class="alert-danger alert"><h3 class="alert-title">Опасно</h3><p >При переопределении <code class="js-func xref js">destroy()</code>, <strong >всегда необходимо</strong> вызывать <code >_super()</code>  иначе, виджет и его дочерние элементы очищаются неправильно, что может привести к утечке памяти и &quot;фантомным событиям&quot;, даже если ошибка не отобразиться</p></div></section><section id="the-qweb-template-engine"><h2 >Шаблонизатор QWeb</h2><p >В предыдущем разделе мы добавляли контент к нашим виджетам, непосредственно манипулируя (и добавляя) ими в DOM:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p >Это позволяет генерировать и отображать любой тип контента, но становится громоздким при генерации значительных объемов DOM (много повторяющихся действий, проблемы с цитированием, ...)</p><p >Как и во многих других средах, решение Odoo заключается в использовании <a href="http://en.wikipedia.org/wiki/Web_template_system" class="external reference">template engine</a>. Шаблонизатор Odoo называется <a href="../reference/qweb.html#reference-qweb" class="internal reference"><span class="std std-ref">Qweb</span></a>.</p><p >QWeb - это язык шаблонов на основе XML, подобный <a href="http://en.wikipedia.org/wiki/Genshi_(templating_language)" class="external reference">Genshi</a>, <a href="http://en.wikipedia.org/wiki/Thymeleaf" class="external reference">Thymeleaf</a> or <a href="http://en.wikipedia.org/wiki/Facelets" class="external reference">Facelets</a>. Он имеет следующие характеристики:</p><ul ><li ><p >Он полностью написан на JavaScript и рендерится в браузере</p></li><li ><p >Каждый файл шаблона (файлы XML) может содержать несколько шаблонов</p></li><li ><p >Он имеет специальную поддержку со стороны Odoo Web <code class="js-class xref js">Widget()</code>, Шаблонизатор может использоваться и вне Odoo веб клиента. (Также возможно использование <code class="js-class xref js">Widget()</code> без Qweb.)</p></li></ul><div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >Обоснованием использования QWeb вместо существующих шаблонизаторов на  javascript является расширяемость собственных (а так же созданных сторонними разработчиками) шаблонов <a href="../reference/views.html#reference-views" class="internal alert-link reference"><span class="std std-ref">представлений</span></a>.</p><p >Большинство шаблонизаторов на javascript основаны на HTML, что исключает упрощенную структурную расширяемость, тогда как XML-шаблонный механизм шаблонов может быть изменен, например, с помощью XPath или CSS и DSL-преобразования дерева (или даже просто XSLT). Гибкость и расширяемость является основной характеристикой Odoo. При применении шаблонизатора Qweb такая гибкость и расширяемость не утрачивается..</p></div></section><section id="using-qweb"><h3 >Использование QWeb</h3><p >Для начала давайте определим простой QWeb шаблон в почти пустом файле``oepetstore/static/src/xml/petstore.xml``:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;background-color: red;&quot;</span><span class="nt">&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p >Теперь мы можем использовать этот шаблон внутри виджета <code >HomePage</code>. Используя переменную загрузчика <code >QWeb</code>, определенную в верхней части страницы, мы можем вызвать шаблон, определенный в файле XML:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p ><code class="js-func xref js">QWeb.render()</code> ищет определенный шаблон преобразовывает в строку и возвращает результат.</p><p >Однако, поскольку <code class="js-class xref js">Widget()</code> имеет специальную интеграцию для QWeb, шаблон можно установить непосредственно на виджете через его атрибут <code class="js-attr xref js">template</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Хотя результат выглядит похожим, между этими подходами есть два различия:</p><ul ><li ><p >во втором варианте, шаблон выдается непосредственно перед вызовом <code class="js-func xref js">start()</code></p></li><li ><p >в первом варианте содержимое шаблона добавляется к корневому элементу виджета, тогда как во втором варианте корневой элемент шаблона сразу устанавливается, как корневой элемент виджета. Вот почему вспомогательный виджет &quot;greetings&quot; sub-widget также получает красный фон</p></li></ul><div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p >Шаблоны должны иметь один корневой элемент без-<code >t</code> особенно если они установлены как <code class="js-attr xref js">template</code>. Если имеется несколько &quot;корневых элементов&quot;, результаты будут не определены (обычно используется только первый корневой элемент, а остальные будут игнорироваться)</p></div></section><section id="qweb-context"><h4 >Работа с Context в Qweb</h4><p >Шаблонам QWeb могут быть предоставлены данные и они могут содержать базовую логику отображения.</p><p >Для явных вызовов <code class="js-func xref js">QWeb.render()</code>, данные шаблона передаются как второй параметр:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Klaus&quot;</span><span class="p">});</span>
</pre></div>
</div>
<p >С измененным шаблоном:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p >будет следующий результат:</p><div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello Klaus<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p >При использовании интеграции <code class="js-class xref js">Widget()</code> не представляется возможным предоставить дополнительные данные шаблону. Шаблон будет иметь единственную контекстную переменную <code >widget</code>, ссылающуюся на виджет, отображаемый непосредственно перед вызовом метода <code class="js-func xref js">start()</code> (состояние виджета будет по существу состоять в том, что установлено <code class="js-func xref js">init()</code>):</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;widget.name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Mordecai&quot;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Результат</p><div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello Mordecai<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
</section><section id="template-declaration"><h4 >Объявление шаблона</h4><p >Мы увидели как происходит визуализация шаблона QWeb, теперь давайте посмотрим синтаксис самих шаблонов</p><p >Шаблон QWeb состоит из обычного XML, смешанного с директивами QWeb. Директива QWeb объявляется с атрибутами XML, начинающимися с <code >t-</code>.</p><p >Самая простая директива это <code >t-name</code>, используемая для объявления новых шаблонов используемых в файле:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;templates&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p ><code >t-name</code> принимает имя определяемого шаблона и объявляет таким образом, что его можно вызвать с помощью <code class="js-func xref js">QWeb.render()</code>. Его можно использовать только на верхнем уровне файла шаблона.</p></section><section id="escaping"><h4 >Вывод данных</h4><p >Директива <code >t-esc</code> может использоваться для вывода текста:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p >Он принимает вычисляемое выражение Javascript, а затем его результат помещается в HTML-код и вставляется в документ. Поскольку это выражение, то можно указать только имя переменной, как показано выше, или более сложное выражение, например какое либо вычисление:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;3+5&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p >или вызов метода:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name.toUpperCase()&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section><section id="outputting-html"><h4 >Вывод HTML</h4><p >Чтобы внедрить HTML-код на отображаемую страницу, используйте <code >t-raw</code>. Подобно <code >t-esc</code> он принимает произвольное Javascript-выражение как параметр, но не выполняет вывод HTML.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-raw=</span><span class="s">&quot;name.link(user_account)&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-danger alert"><h3 class="alert-title">Опасно</h3><p ><code >t-raw</code> не должен использоваться * для любых данных, которые могут содержать небезопасный пользовательский контент, поскольку это приводит к уязвимостям <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" class="external reference alert-link">cross-site scripting</a></p></div></section><section id="conditionals"><h4 >Условные выражения</h4><p >QWeb может использовать условия используя блок <code >t-if</code>. Директива принимает произвольное выражение, если выражение не существует (<code >false</code>, <code >null</code>, <code >0</code> или пустая строка) блок не выводиться, в противном случае он отображается.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;true == true&quot;</span><span class="nt">&gt;</span>
        true is true
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;true == false&quot;</span><span class="nt">&gt;</span>
        true is not true
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >QWeb не имеет &quot;else&quot; структутуры, используйте второй <code >t-if</code> с инвертированным первоначальным условием. Если это сложное или ресурсоемкое выражение, сохраните его в переменную</p></div></section><section id="iteration"><h4 >Перебор значений</h4><p >Для перебора значений используется <code >t-foreach</code> и <code >t-as</code>. <code >t-foreach</code> принимает выражение, возвращающее список для перебора, <code >t-as</code> - это имя переменной для привязки к каждому элементу во время перебора.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;names&quot;</span> <span class="na">t-as=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p ><code >t-foreach</code> так же может быть использован с числами и объектами (словарями</p></div></section><section id="defining-attributes"><h4 >Определение атрибутов</h4><p >QWeb предоставляет две связанные директивы для определения атрибутов HTML: <code class="samp">t-att-<em >name</em></code> и <code class="samp">t-attf-<em >name</em></code>. В любом случае, <em >name</em> это имя создаваемого атрибута (например <code >t-att-id</code> определяет атрибут <code >id</code> после визуализации)</p><p ><code >t-att-</code> принимает выражение javascript, результат которого устанавливается как значение атрибута. Эти директивы наиболее полезны, если все значение атрибута вычисляемые:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
    Input your name:
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">t-att-value=</span><span class="s">&quot;defaultName&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p ><code >t-attf-</code> принимает <em >строковый формат</em>. Строковый формат это текст с интерполяционными блоками. Интерполяционный блок - это javascript-выражение между <code >{{</code> и <code >}}</code>, который будет заменен результатом выражения. Это особенно полезно для атрибутов, которые частично имеют текстовые значения и частично вычисляемые, например класс:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div</span> <span class="na">t-attf-class=</span><span class="s">&quot;container {{ left ? &#39;text-left&#39; : &#39;&#39; }} {{ extra_class }}&quot;</span><span class="nt">&gt;</span>
    insert content here
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</section><section id="calling-other-templates"><h4 >Вызов других шаблонов</h4><p >Шаблоны можно разбить на подшаблоны (для простоты, управляемости, многократного использования или во избежание чрезмерной перегрузки разметки)</p><p >Это реализовано с помощью <code >t-call</code> директивы, которая принимает имя шаблона для визуализации:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-a&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;B&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-b&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p >визуализация <code >A</code> шаблона даст результат:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-a&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-b&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p >Суб-шаблоны наследуют контекст при визуализации вызывающего их объекта.</p></section><section id="to-learn-more-about-qweb"><h4 >Для более глубокого изучения QWeb</h4><p >Для подробной справки по QWeb смотрите <a href="../reference/qweb.html#reference-qweb" class="internal reference"><span class="std std-ref">Qweb</span></a>.</p></section><section id="exercise"><h4 >Упражнение</h4><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Использование QWeb в Widget</p><p >Создайте виджет, конструктор которого имеет два параметра помимо <code >parent</code>: <code >product_names</code> и <code >color</code>.</p><ul ><li ><p ><code >product_names</code> должен быть массивом строк, каждая из которых - название продукта</p></li><li ><p ><code >color</code> строка содержащая цвет в CSS цветовом формате (например: <code >#000000</code> для черного)</p></li></ul><p >Виджет должен отображать названия продуктов друг под другом, каждый в отдельном поле с цветом фона и значением <code >color</code> и границы. Вы должны использовать QWeb для визуализации HTML. Все что касается CSS должно находится в <code >oepetstore/static/src/css/petstore.css</code>.</p><p >Используйте виджет в <code >HomePage</code> с полдюжиной продуктов.</p></div></section><section id="widget-helpers"><h2 >Помощники для Widget</h2></section><section id="widget-s-jquery-selector"><h3 ><code >Widget</code>'s jQuery Selector</h3><p >Выбор элементов DOM внутри виджетов можно выполнить, вызвав метод <code >find()</code> в корне DOM виджета:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;input.my_input&quot;</span><span class="p">)...</span>
</pre></div>
</div>
<p >Но поскольку это обычная операция, <code class="js-class xref js">Widget()</code> предоставляет эквивалентный ярлык через метод the <code class="js-func xref js">$()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input.my_input&quot;</span><span class="p">)...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<div role="alert" class="alert-warning alert"><h3 class="alert-title">Предупреждение</h3><p >Не используйте глобальную функцию jQuery <code >$()</code> без лишней необходимости: наборы объявленные в корне виджета относятся только к данному виджету, тогда как <code >$()</code> является глобальной ко всей странице/приложению и могут соответствовать частям других виджетов и представлений, приводя к опасным побочным эффектам. А, поскольку виджет вообще должен действовать только в своем разделе DOM, нет причины для выбора глобальной функции.</p></div></section><section id="easier-dom-events-binding"><h3 >Простое связывание DOM событий</h3><p >Ранее мы связывали события DOM с помощью обычных обработчиков событий jQuery (например <code >.click ()</code> или <code >.change ()</code>) на элементах виджета:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.my_button&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">button_clicked</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Хотя это метод и работает, у него есть несколько проблем:</p><ol ><li ><p >он довольно многословный</p></li><li ><p >он не поддерживает замену корневого элемента виджета во время выполнения, поскольку привязка выполняется только при запуске <code >start()</code> (во время инициализации виджета)</p></li><li ><p >он требует решения <code >this</code>-связанных проблем</p></li></ol><p >Таким образом, виджеты предоставляют ярлык привязки события DOM через <code class="js-attr xref js">events</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;click .my_button&quot;</span><span class="o">:</span> <span class="s2">&quot;button_clicked&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p ><code class="js-attr xref js">events</code> это объект (отображение) события в функцию или метод для вызова, когда событие инициируется:</p><ul ><li ><p >ключ - это имя события, которое может быть уточнено с помощью селектора CSS, и в этом случае, только если событие произойдет в выбранном подэлементе, будет выполняться функция или метод: <code >click</code> будет обрабатывать все клики внутри виджета, а <code >click .my_button</code> будет обрабатывать только клики в элементах с классом <code >my_button</code></p></li><li ><p >Значение - это действие, которое должно выполняться при срабатывании события</p><p >Это может быть либо функция:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;click&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* code here */</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p >Или имя метода объекта (см. Пример выше).</p><p >В любом случае <code >this</code> является экземпляром виджета, а обработчику задан единственный параметр - <a href="http://api.jquery.com/category/events/event-object/" class="external reference">jQuery event object</a> для события.</p></li></ul></section><section id="widget-events-and-properties"><h2 >События и свойства Widget</h2></section><section id="events"><h3 >События</h3><p >Виджеты предоставляют систему событий (свою, отдельно от описанной выше систем событий DOM/jQuery): виджет может сам запускать события, а другие виджеты (или сам) могут, при настройке связи, прослушивать эти события:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;click button.ok_button&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;user_chose&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="s1">&#39;click button.cancel_button&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;user_chose&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Are you sure you want to perform this action?&lt;/div&gt;&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;button class=&#39;ok_button&#39;&gt;Ok&lt;/button&gt;&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;button class=&#39;cancel_button&#39;&gt;Cancel&lt;/button&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Этот виджет виден, он преобразует входные данные пользователя (через события DOM) во внутреннее событие для родительских виджетов.</p><p ><code class="js-func xref js">trigger()</code> принимает имя события для запуска в качестве его первого (обязательного) аргумента, любые дополнительные аргументы рассматриваются как данные события и передаются непосредственно слушателям.</p><p >Затем мы можем настроить родительское событие, создающее экземпляр нашего общего виджета, и прослушивать событие <code >user_chose</code> используя метод <code class="js-func xref js">on()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;user_chose&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">user_chose</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">user_chose</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The user agreed to continue&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The user refused to continue&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p ><code class="js-func xref js">on()</code> связывает функцию, которая будет вызываться, когда событие идентифицировано <code >event_name</code>. Аргумент <code >func</code> это функция для вызова, <code >object</code> - объект, с которым связана эта функция, если это метод. Связанная функция будет вызываться с дополнительными аргументами <code class="js-func xref js">trigger()</code> если они есть. Пример:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">my_event_triggered</span><span class="p">);</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">my_event_triggered</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
    <span class="c1">// will print &quot;1 2 3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >Запуск событий в другом виджете, как правило, плохая идея. Основное исключение из этого правила - <code >odoo.web.bus</code>, который существует специально для трансляций. Любой виджет может запрашивать данные в веб-приложении Odoo.</p></div></section><section id="properties"><h3 >Свойства</h3><p >Свойства очень похожи на обычные атрибуты объектов, поскольку они позволяют хранить данные в экземпляре виджетов, однако у них есть дополнительная функция, при которой они запускают события при установке:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:name&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name_changed</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Nicolas&quot;</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">name_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The new value of the property &#39;name&#39; is&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<ul ><li ><p ><code class="js-func xref js">set()</code> устанавливает значение свойства и запускает <code class="samp">change:<em >propname</em></code> (где <em >propname</em> это имя свойства, переданное в качестве первого параметра для <code class="js-func xref js">set()</code>) и <code >change</code></p></li><li ><p ><code class="js-func xref js">get()</code> извлекает значение свойства.</p></li></ul></section><section id="id3"><h3 >Упражнение</h3><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Свойства и события виджета</p><p >Создайте виджет <code >ColorInputWidget</code> который будет отображать 3 <code >&lt;input type=&quot;text&quot;&gt;</code>. Каждый из этих <code >&lt;input&gt;</code> предназначен для ввода шестнадцатеричного числа от 00 до FF. Когда какой-либо из этих <code >&lt;input&gt;</code> изменяется пользователем, виджет должен запрашивать содержимое трех <code >&lt;input&gt;</code>, соединять их значения, чтобы иметь полный цветовой код CSS (например: <code >#00FF00</code>) и поместить результат в свойство с именем <code >color</code>. Обратите внимание, что событие jQuery <code >change()</code> которое вы можете привязать к любому элементу HTML <code >&lt;input&gt;</code> и метод <code >val()</code>, который может запрашивать текущее значение этого <code >&lt;input&gt;</code> могут быть полезны в этом упражнении.</p><p >Затем измените виджет <code >HomePage</code>, чтобы создать <code >ColorInputWidget</code> и отобразить его. Виджет <code >HomePage</code> также должен отображать пустой прямоугольник. Этот прямоугольник должен всегда, в любой момент, иметь тот же цвет фона, что и цвет в свойстве <code >color</code> экземпляра <code >ColorInputWidget</code>.</p><p >Используйте QWeb для генерации HTML.</p></div></section><section id="modify-existing-widgets-and-classes"><h2 >Изменение существующих виджетов и классов</h2><p >Система классов веб-фреймворка Odoo позволяет напрямую модифицировать существующие классы с помощью метода <code class="js-func xref js">include()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">TestClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;hello&quot;</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">TestClass</span><span class="p">.</span><span class="nx">include</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; world&quot;</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">TestClass</span><span class="p">().</span><span class="nx">testMethod</span><span class="p">());</span>
<span class="c1">// will print &quot;hello world&quot;</span>
</pre></div>
</div>
<p >Эта система похожа на механизм наследования, за исключением того, что она изменит целевой класс на месте вместо создания нового класса.</p><p >В этом случае, <code >this._super()</code> будет вызывать оригинальную реализацию заменяемого/переопределяемого метода. Если у класса уже есть подклассы, все вызовы  <code >this._super()</code> в подклассах вызовут новые реализации, определенные в вызове <code class="js-func xref js">include()</code>. Это будет работать, если некоторые экземпляры класса (или любого из его подклассов) были созданы до вызова <code class="js-func xref js">include()</code>.</p></section><section id="translations"><h2 >Система переводов на другие языки</h2><p >Процесс преобразования текста в код Python и JavaScript очень похож. Вы могли заметить эти строки в начале файла <code >petstore.js</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
    <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
</pre></div>
</div>
<p >Эти строки просто используются для импорта функций перевода в текущий модуль JavaScript. Они используются следующим образом:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_t</span><span class="p">(</span><span class="s2">&quot;Hello user!&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p >В Odoo файлы переводов автоматически генерируются путем сканирования исходного кода. Обнаружен весь кусок кода, вызывающий определенную функцию, и их содержимое добавляется в файл перевода, который затем отправляется переводчикам. В Python, это функция <code >_()</code>. В JavaScript это функция <code class="js-func xref js">_t()</code> (и еще <code class="js-func xref js">_lt()</code>).</p><p >Функция <code >_t()</code> возвращает перевод, определенный для текста, который задан. Если для этого текста не определен перевод, то она вернет исходный текст как есть.</p><div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >Чтобы вводить пользовательские значения в переносимые строки, рекомендуется использовать <a href="http://gabceb.github.io/underscore.string.site/#sprintf" class="external reference alert-link">_.str.sprintf</a> с именованными аргументами <em >после</em> перевода:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">str</span><span class="p">.</span><span class="nx">sprintf</span><span class="p">(</span>
    <span class="nx">_t</span><span class="p">(</span><span class="s2">&quot;Hello, %(user)s!&quot;</span><span class="p">),</span> <span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="s2">&quot;Ed&quot;</span>
<span class="p">}));</span>
</pre></div>
</div>
<p >Это делает переводы более удобочитаемыми для переводчиков и дает им большую гибкость для изменения порядка или игнорирования параметров.</p></div><p ><code class="js-func xref js">_lt()</code> (&quot;ленивый перевод&quot;) похож, но несколько более сложен: вместо перевода его параметра сразу, он возвращает объект, который при преобразовании в строку будет выполнять перевод</p><p >Данный механизм используется для определения переводимых терминов до инициализации системы переводов, например, для атрибутов класса (поскольку модули загружаются до того, как язык пользователя настроен и загружены переводы).</p></section><section id="communication-with-the-odoo-server"><h2 >Связь с сервером Odoo</h2></section><section id="contacting-models"><h3 >Взаимодействие с моделями данных</h3><p >Большинство операций с Odoo связаны со взаимодействием с моделями данных, реализующими бизнес-логику, и эти модели данных будут (потенциально) взаимодействовать с какой либо системой хранения  (обычно <a href="http://en.wikipedia.org/wiki/PostgreSQL" class="external reference">PostgreSQL</a>).</p><p >Хотя <a href="http://jquery.org" class="external reference">jQuery</a> предоставляет функцию <a href="http://api.jquery.com/jquery.ajax/" class="external reference">$.ajax</a> для сетевых взаимодействий, для связи с Odoo требуются дополнительные метаданные, настройка которых перед каждым вызовом будет многословной и подверженной ошибкам. В результате, веб клиент Odoo предоставляет примитивы связей более высокого уровня.</p><p >Чтобы продемонстрировать это, файл <code >petstore.py</code> уже содержит небольшую модель с образцом:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">message_of_the_day</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;oepetstore.message_of_the_day&quot;</span>

    <span class="nd">@api.model</span>
    <span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
</pre></div>
</div>
<p >В этом примере объявлена модель данных с двумя полями и методом <code >my_method ()</code>, который возвращает словарь литералов.</p><p >Вот пример виджета, который вызывает <code >my_method ()</code> и отобразит результат:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s2">&quot;oepetstore.message_of_the_day&quot;</span><span class="p">);</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">);</span>
            <span class="c1">// will show &quot;Hello world&quot; to the user</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Класс, используемый для вызова моделей данных Odoo <code class="js-class xref js">odoo.Model()</code>. Он создается с именем модели данных Odoo в качестве первого параметра (в нашем случае <code >oepetstore.message_of_the_day</code>).</p><p ><code class="js-func xref js">call()</code> можно использовать для вызова любого (публичного) метода модели Odoo. Он принимает следующие позиционные аргументы:</p><dl ><dt ><code >name</code></dt><dd ><p >Имя вызываемого метода (в нашем случае <code >my_method</code>)</p></dd><dt ><code >args</code></dt><dd ><p >массив <a href="https://docs.python.org/2/glossary.html#term-argument" class="external reference">positional arguments</a> для предоставления метода. Поскольку пример не имеет позиционного аргумента, параметр <code >args</code> не предоставляется.</p><p >Вот другой пример с позиционными аргументами:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd><dt ><code >kwargs</code></dt><dd ><p >Отображение <a href="https://docs.python.org/2/glossary.html#term-argument" class="external reference">keyword arguments</a> для передачи. В примере представлен одиночный аргумент <code >context</code>.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd></dl><p ><code class="js-func xref js">call()</code> возвращает отложенное разрешенное значение, возвращаемое методом модели данных в качестве первого аргумента.</p></section><section id="compoundcontext"><h3 >CompoundContext - составной контекст</h3><p >В предыдущем разделе использовался аргумент <code >context</code>, который не был объяснен в вызове метода:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()})</span>
</pre></div>
</div>
<p >Контекст подобен &quot;магическому&quot; аргументу, который веб-клиент всегда будет выдавать серверу при вызове метода. Контекст - это словарь, содержащий несколько ключей. Одним из наиболее важных ключей является язык пользователя, используемый сервером для перевода всех сообщений приложения. Другой - часовой пояс пользователя, используемый для правильного вычисления дат и времени, для одновременного использования Odoo людьми в находящихся в разных странах.</p><p ><code >argument</code> необходим во всех методах, в противном случае могут произойти плохие вещи (например, приложение неправильно переводится). Вот почему, когда вы вызываете метод модели данных, вы всегда должны предоставлять этот аргумент. Решением этого является использование <code class="js-class xref js">odoo.web.CompoundContext()</code>.</p><p ><code class="js-class xref js">CompoundContext()</code> это класс, используемый для передачи пользователю контекста (с языком, часовым поясом и т.д.) На сервер, а также добавление новых ключей в контекст (в некоторых моделях данных используются произвольные ключи, добавленные в контекст). Он создается путем предоставления его конструктору любого количества словарей или других экземпляров <code class="js-class xref js">CompoundContext()</code>. Он объединит все эти контексты перед отправкой их на сервер.</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">({</span><span class="s1">&#39;new_key&#39;</span><span class="o">:</span> <span class="s1">&#39;key_value&#39;</span><span class="p">})})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">context</span>
    <span class="o">//</span> <span class="n">will</span> <span class="k">print</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="s1">&#39;en_US&#39;</span><span class="p">,</span> <span class="s1">&#39;new_key&#39;</span><span class="p">:</span> <span class="s1">&#39;key_value&#39;</span><span class="p">,</span> <span class="s1">&#39;tz&#39;</span><span class="p">:</span> <span class="s1">&#39;Europe/Brussels&#39;</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p >Вы можете видеть, что словарь в аргументе <code >context</code> содержит некоторые ключи, которые связаны с конфигурацией текущего пользователя в Odoo плюс ключ <code >new_key</code>, который был добавлен при создании экземпляра <code class="js-class xref js">CompoundContext()</code>.</p></section><section id="queries"><h3 >Запросы</h3><p >В то время как <code class="js-func xref js">call()</code> достаточен для любого взаимодействия с моделями данных Odoo, Odoo Web предоставляет помощника для более простого и ясного формирования запросов к моделям данных (выборки записей на основе различных условий): <code class="js-func xref js">query()</code> который действует как сокращение до простой комбинации <a href="../reference/orm.html#odoo.models.Model.search" class="internal reference" title="odoo.models.Model.search"><code class="py py-meth xref">search()</code></a> и :<a href="../reference/orm.html#odoo.models.Model.read" class="internal reference" title="odoo.models.Model.read"><code class="py py-meth xref">read()</code></a>. Он обеспечивает более четкий синтаксис для поиска и чтения моделей данных:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">])</span>
     <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;company_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]])</span>
     <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
     <span class="p">.</span><span class="nx">all</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do work with users records</span>
<span class="p">});</span>
</pre></div>
</div>
<p >против:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;company_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]],</span> <span class="p">{</span><span class="nx">limit</span><span class="o">:</span> <span class="mi">15</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ids</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">ids</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">]]);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// do work with users records</span>
    <span class="p">});</span>
</pre></div>
</div>
<ul ><li ><p ><code class="js-func xref js">query()</code> принимает необязательный список полей в качестве параметра (если не указано ни одного поля, выбираются все поля модели данных). Он возвращает <code class="js-class xref js">odoo.web.Query()</code>, который может быть дополнительно настроен перед выполнением.</p></li><li ><p ><code class="js-class xref js">Query()</code> представляет собой построенный запрос. Он неизменен, методы для настройки запроса фактически возвращают измененную копию, поэтому можно использовать оригинальную и новую версии бок о бок. Смотрите <code class="js-class xref js">Query()</code> для настройки его параметров.</p></li></ul><p >Когда запрос настроен так как вам нужно, просто вызовите функцию <code class="js-func xref js">all()</code> чтобы выполнить его, и верните отложенный вызов к его результату. Результат - то же самое, что <a href="../reference/orm.html#odoo.models.Model.read" class="internal reference" title="odoo.models.Model.read"><code class="py py-meth xref">read()</code></a>'s, массив словарей, где каждый словарь является запрошенной записью, при этом каждое запрошенное поле является словарным ключом.</p></section><section id="exercises"><h2 >Упражнения</h2><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Послание дня</p><p >Создайте виджет <code >MessageOfTheDay</code>  отображающий последнюю запись модели данных <code >oepetstore.message_of_the_day</code>. Виджет должен получать свою запись сразу после ее отображения.</p><p >Отобразите виджет на домашней странице Pet Store.</p></div><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Список игрушек для домашних животных</p><p >Создайте виджет <code >PetToysList</code> отображающий 5 игрушек (используя их имя и их изображения).</p><p >Игрушки для животных не хранятся в новой модели, вместо этого они хранятся в <code >product.product</code> с использованием специальной категории <em >Pet Toys</em>. Вы можете увидеть заранее сгенерированные игрушки и добавить новые, зайдя в <span class="menuselection">Pet Store ‣ Pet Store ‣ Pet Toys</span>. Вам, вероятно, понадобится изучить <code >product.product</code> чтобы создать правильный домен, чтобы выбрать только игрушки для домашних животных.</p><p >В Odoo, изображения обычно хранятся в обычных полях, закодированных как <a href="http://en.wikipedia.org/wiki/Base64" class="external reference alert-link">base64</a>, HTML поддерживает вывод изображений прямо из base64 с помощью тега <code class="samp">&lt;img src=&quot;data:<em >mime_type</em>;base64,<em >base64_image_data</em>&quot;/&gt;</code></p><p >Виджет <code >PetToysList</code> должен отображаться на домашней странице справа от виджета  <code >MessageOfTheDay</code>. Для этого вам понадобится сделать макет с CSS.</p></div></section><section id="existing-web-components"><h2 >Существующие веб-компоненты</h2></section><section id="the-action-manager"><h3 >Менеджер действий</h3><p >В Odoo многие операции начинаются с <a href="../reference/actions.html#reference-actions" class="internal reference"><span class="std std-ref">action</span></a>: открытие элемента меню (для вида), печать отчета, ...</p><p >Действия - это фрагменты данных, описывающие реакцию клиента на активацию части содержимого. Действия могут быть сохранены (и считаны с помощью модели данных), или они могут быть сгенерированы «на лету» (локально для клиента кодом javascript или дистанционно с помощью метода модели данных).</p><p >В Odoo Web, компонентом, ответственным за обработку и реакцию на эти действия, является <em >Action Manager</em>.</p></section><section id="using-the-action-manager"><h4 >Использование менеджера действий</h4><p >Администратор действий может быть явно вызван из javascript-кода, создав словарь, описывающий <a href="../reference/actions.html#reference-actions" class="internal reference"><span class="std std-ref">действие</span></a> нужного типа, и вызов экземпляра менеджера действий вместе с ним.</p><p ><code class="js-func xref js">do_action()</code> это ссылка <code class="js-class xref js">Widget()</code> просматривающий &quot;текущий&quot; менеджер действий и выполняющий действие:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">TestWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">dispatch_to_new_action</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">do_action</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ir.actions.act_window&#39;</span><span class="p">,</span>
            <span class="nx">res_model</span><span class="o">:</span> <span class="s2">&quot;product.product&quot;</span><span class="p">,</span>
            <span class="nx">res_id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">views</span><span class="o">:</span> <span class="p">[[</span><span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">]],</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;current&#39;</span><span class="p">,</span>
            <span class="nx">context</span><span class="o">:</span> <span class="p">{},</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p >Наиболее распространенный <code >type</code> действия - <code >ir.actions.act_window</code> , который предоставляет представления к модели (отображает модель различными способами), ее наиболее распространенными атрибутами являются:</p><dl ><dt ><code >res_model</code></dt><dd ><p >Модель для отображения в представлениях</p></dd><dt ><code >res_id</code> (опционально)</dt><dd ><p >Для представлений вида Form предварительно выбранная запись <code >res_model</code></p></dd><dt ><code >views</code></dt><dd ><p >Для представлений вида Form предварительно выбранная запись <code >[view_id, view_type]</code>, <code >view_id</code> может быть либо идентификатором представления правильного типа в базе данных , либо <code >false</code> чтобы использовать представление по умолчанию для указанного типа. Типы представлений не могут присутствовать несколько раз. Действие по умолчанию откроет первое представление из списка.</p></dd><dt ><code >target</code></dt><dd ><p >Либо <code >current</code> (по умолчанию), который заменяет «содержимое» раздела веб-клиента действием, либо <code >new</code>, чтобы открыть действие в диалоговом окне.</p></dd><dt ><code >context</code></dt><dd ><p >Дополнительные данные контекста для использования в действии.</p></dd></dl><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Перейти к продукту</p><p >Измените компонент <code >PetToysList</code> чтобы щелкнуть игрушку, заменит домашнюю страницу представлением вида Form игрушки.</p></div></section><section id="client-actions"><h3 >Действия клиента</h3><p >В этом руководстве мы использовали простой виджет <code >HomePage</code>, который автоматически запускается веб-клиентом, когда мы выбираем нужный пункт меню. Но как веб-клиент Odoo узнал о том, что нужно запустить именно этот виджет? Это потому, что виджет зарегистрирован как <em >действие клиента</em>.</p><p >Клиентское действие (как следует из его названия) является типом действия, определенным почти полностью в клиенте, в javascript для веб-клиента Odoo. Сервер просто отправляет тег действия (произвольное имя) и, при необходимости, добавляет несколько параметров, но помимо этого <em >всё</em> обрабатывается пользовательским кодом клиента.</p><p >Наш виджет зарегистрирован как обработчик для действия клиента следующим образом:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p ><code >instance.web.client_actions</code> это <code class="js-class xref js">Registry()</code> , в котором менеджер действий ищет обработчики действий клиента, когда ему нужно его выполнить. Первый параметр <code class="js-class xref js">add()</code> это имя (тег) действия клиента, а вторым параметром является путь к виджету из корня веб-клиента Odoo</p><p >Когда клиентское действие должно быть выполнено, менеджер действий ищет свой тег в реестре, проходит указанный путь и отображает виджет, который он находит в конце.</p><div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><p >обработчик действий клиента также может быть регулярной функцией, в случае, когда он будет вызван, и его результат (если он есть) будет интерпретироваться как следующее действие для выполнения.</p></div><p >На стороне сервера мы просто определили действие <code >ir.actions.client</code>:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;action_home_page&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.actions.client&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;tag&quot;</span><span class="nt">&gt;</span>petstore.homepage<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<p >добавляем действие в нужный пункт меню:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;home_page_petstore_menu&quot;</span> <span class="na">parent=</span><span class="s">&quot;petstore_menu&quot;</span>
          <span class="na">name=</span><span class="s">&quot;Home Page&quot;</span> <span class="na">action=</span><span class="s">&quot;action_home_page&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</section><section id="architecture-of-the-views"><h3 >Архитектура представлений</h3><p >Значительная часть полезных качеств (и соотвественно возникающих с этим сложностей) веб-клиента Odoo находится в представлениях. Каждый тип представления - это способ отображения модели данных на клиенте</p></section><section id="the-view-manager"><h4 >Менеджер представлений</h4><p >Когда экземпляр <code >ActionManager</code> получает действие типа <code >ir.actions.act_window</code>, , делегирует синхронизацию и обработку самих представлений <em >менеджеру представлений</em>, который затем настраивает одно или несколько представлений в зависимости от требований исходного действия:</p><a href="../_images/viewarchitecture.svg" class="internal reference"><img src="../_images/viewarchitecture.svg" class="img-responsive center-block"></a></section><section id="the-views"><h4 >Представления</h4><p >Большинство <a href="../reference/views.html#reference-views" class="internal reference"><span class="std std-ref">представлений Odoo</span></a> реализованы через подкласс <code class="js-class xref js">odoo.web.View()</code>, который предоставляет общую базовую структуру для обработки событий и отображения информации о модели данных.</p><p ><em >Представление вида Search</em> считается основным типом представления в Odoo фреймворке, но обрабатывается отдельно веб-клиентом (как правило оно является постоянным и может взаимодействовать с другими представлениями, чего не делают обычные представления).</p><p >Представление отвечает за загрузку собственного XML описания (с помощью <a href="../reference/orm.html#odoo.models.Model.fields_view_get" class="internal reference" title="odoo.models.Model.fields_view_get"><code class="py xref py-class">fields_view_get</code></a>) и любого другого источника данных, в котором он нуждается. С этой целью представления оснащаются необязательным идентификатором представления, заданным как атрибут <code class="js-attr xref js">view_id</code>.</p><p >Представления также оснащаются экземпляром <code class="js-class xref js">DataSet()</code>, который содержит самую необходимую информацию о модели данных (ее название и, возможно, различные идентификаторы записи).</p><p >Представления также могут обрабатывать поисковые запросы путем переопределения <code class="js-func xref js">do_search()</code>, и при необходимости обновлять свой <code class="js-class xref js">DataSet()</code>.</p></section><section id="the-form-view-fields"><h3 >Поля представлений вида Form</h3><p >Обычной потребностью является расширение представления вида Form для добавления новых способов отображения полей.</p><p >Все встроенные поля имеют реализацию отображения по умолчанию, новый виджет формы может понадобиться для правильного взаимодействия с новым типом поля (например, поле <a href="../glossary.html#term-gis" class="internal reference"><span class="std std-term xref">GIS</span></a>) или для предоставления новых образов и способов взаимодействия с существующими типами полей (например, проверки полей <a href="../reference/orm.html#odoo.fields.Char" class="internal reference" title="odoo.fields.Char"><code class="py xref py-class">Char</code></a>)который должен содержать адреса электронной почты и отображать их в виде сообщений электронной почты.</p><p >Чтобы явно указать, какой вид виджета следует использовать для отображения поля, просто используйте атрибут <code >widget</code> в XML описании представления:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;contact_mail&quot;</span> <span class="na">widget=</span><span class="s">&quot;email&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-info alert"><h3 class="alert-title">Примечание</h3><ul ><li ><p >один и тот же виджет представления вида Form используется как в режиме &quot;просмотра&quot; (только для чтения) и &quot;редактирования&quot;, нельзя использовать один виджет для одного режима, а другой для другого</p></li><li ><p >одно и тоже поле (имя поля) нельзя использовать в представлении вида Form</p></li><li ><p >Виджет может игнорировать текущий режим представления вида Form и может оставаться неизменным как в режиме просмотра, так и в режиме редактирования</p></li></ul></div><p >Поля создаются экземпляром представления вида Form после того, как оно прочитало свое XML описание и сформирован соответствующий HTML код, представляющий это описание. После этого представление вида Form будет взаимодействовать с объектами поля с использованием методов. Эти методы определены интерфейсом <code >FieldInterface</code>. Почти все поля наследуют абстрактный класс <code >AbstractField</code>. Этот класс определяет некоторые механизмы по умолчанию, которые должны быть реализованы большинством полей.</p><p >Вот некоторые из обязанностей класса поля:</p><ul ><li ><p >Класс поля должен отображать и разрешать пользователю редактировать значение поля.</p></li><li ><p >Он должен правильно реализовать 3 атрибута поля, доступных во всех полях Odoo. Класс <code >AbstractField</code> уже реализует алгоритм, который динамически вычисляет значение этих атрибутов (они могут измениться в любой момент, потому что их значение изменяется в соответствии со значением других полей). Эти значения хранятся в <em >Widget Properties</em>  (свойства виджета были объяснены ранее в этом руководстве). Каждый класс поля несет ответственность за проверку свойств виджета и динамическую адаптацию в зависимости от их значений. Вот описание каждого из этих атрибутов:</p><ul ><li ><p ><code >required</code>: поле должно иметь значение перед сохранением. Если <code >required</code> имеет значение <code >true</code> и поле не имеет значения, метод поля <code >is_valid()</code> должен возвращать <code >false</code>.</p></li><li ><p ><code >invisible</code>: Когда <code >true</code>, поле должно быть невидимым. Класс <code >AbstractField</code> уже имеет базовую реализацию этого поведения, которая подходит для большинства полей.</p></li><li ><p ><code >readonly</code>: Когда <code >true</code>, поле нельзя редактировать пользователю. Большинство полей в Odoo имеют совершенно другое поведение в зависимости от значения <code >readonly</code>. Например, <code >FieldChar</code> отображает HTML <code >&lt;input&gt;</code> когда он редактируемый и просто отображает текст, когда он доступен только для чтения. Это также означает, что требуется гораздо больше кода для реализации только этого поведения, но это необходимо для создания удобного пользовательского интерфейса.</p></li></ul></li><li ><p >Поля имеют два метода, <code >set_value()</code> и <code >get_value()</code>,  которые вызываются представлением вида Form, чтобы придать ему значение для отображения и возврата к новому значению, введенному пользователем. Эти методы должны уметь обрабатывать значение, заданное сервером Odoo, когда выполняется функция <code >read()</code> для модели данных и возвращать допустимое значение для <code >write()</code>.  Помните, что типы данных JavaScript / Python, используемые для представления значений, заданных <code >read()</code> и отданных <code >write()</code> не обязательно должны быть одинаковы в Odoo. Например, когда вы читаете many2one, это всегда кортеж, первым значением которого является идентификатор указанной записи, а вторым является имя (например: <code >(15, &quot;Agrolait&quot;)</code>). Но когда вы делаете запись в many2one, это должно быть одно целое число, а не кортеж. <code >AbstractField</code> имеет реализацию этих методов по умолчанию, которая хорошо работает для простых типов данных и устанавливает свойство виджета с именем <code >value</code>.</p></li></ul><p >Обратите внимание, что для лучшего понимания того, как реализовать поля, вам настоятельно рекомендуется посмотреть определение интерфейса <code >FieldInterface</code> и класса <code >AbstractField</code> непосредственно в коде веб клиента Odoo.</p></section><section id="creating-a-new-type-of-field"><h4 >Создание нового типа поля</h4><p >В этой части мы объясним, как создать новый тип поля. Примером здесь будет повторная реализация класса `` FieldChar`` с постепенным объяснением каждой части.</p></section><section id="simple-read-only-field"><h5 >Простое поле только для чтения</h5><p >Вот первая реализация, которая будет отображать только текст. Пользователь не сможет изменять содержимое поля.</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;char2&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.FieldChar2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p >В этом примере мы объявляем класс с именем <code >FieldChar2</code>, который является наследником``AbstractField``. Мы также регистрируем этот класс в реестре <code >instance.web.form.widgets</code> с ключом <code >char2</code>. Это позволит нам использовать это новое поле в любом представлении вида Form, указав <code >widget=&quot;char2&quot;</code> в теге <code >&lt;field/&gt;</code> при создании XML описании представления.</p><p >В этом примере мы определяем единственный метод: <code >render_value()</code>. Все, что он делает - так это отображает <code >value``свойства виджета. Это два инструмента, определенные классом ``AbstractField</code>. Как объяснялось ранее, представление вида Form вызовет метод поля <code >set_value()</code>, чтобы установить отображаемое значение. У этого метода уже есть реализация по умолчанию в <code >AbstractField</code>, которая просто устанавливает <code >value</code>. <code >AbstractField</code> также смотрит событие <code >change:value</code> направленное на себя и вызывает <code >render_value()</code> когда это происходит. Таким образом, <code >render_value()</code> это удобный метод для реализации в дочерних классах выполнения некоторых операции каждый раз, когда изменяется значение поля.</p><p >В методе <code >init()</code> мы также определяем значение поля по умолчанию, если в представлении формы не указано ни одного (здесь мы предполагаем, что значение по умолчанию поля <code >char</code> должно быть пустой строкой).</p></section><section id="read-write-field"><h5 >Поле для чтения-записи</h5><p >Поля, доступные только для чтения, которые отображают только контент и не позволяют пользователю изменять его, могут быть полезны, однако большинство полей в Odoo также позволяют себя редактировать. Это усложняет реализацию классов полей, главным образом потому, что поля должны обрабатывать как редактируемый, так и нередактируемый режим, эти режимы часто совершенно разные (для целей дизайна и удобства использования), и поля должны иметь возможность переключаться между режимами в любой момент.</p><p >Чтобы узнать, в каком режиме должно быть текущее поле, класс <code >AbstractField</code> задает свойство виджета с именем <code >effective_readonly</code>. Поле должно следить за изменениями в этом свойстве виджета и соответственно отображать правильный режим. Например:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:effective_readonly&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render_value</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_field</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;FieldChar2&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">widget</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">internal_set_value</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;char2&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.FieldChar2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;FieldChar2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_field_char2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;! widget.get(&#39;effective_readonly&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p >В методе <code >start()</code> (который вызывается сразу же после добавления виджета в DOM), мы связываемся с изменением события <code >change:effective_readonly</code>. Это позволяет нам повторно отображать поле каждый раз, когда свойство виджета изменяет значение <code >effective_readonly</code>. Этот обработчик будет вызывать  <code >display_field()</code>, который также вызывается непосредственно в <code >start()</code>. Этот <code >display_field()</code> был создан специально для этого поля, это не метод, определенный в <code >AbstractField</code> или любом другом классе. Мы можем использовать этот метод для отображения содержимого поля в зависимости от текущего режима.</p><p >С этого момента концепция этого поля является типичной, за исключением того, что есть много проверок, чтобы узнать состояние свойства <code >effective_readonly</code>:</p><ul ><li ><p >В шаблоне QWeb используемом для отображения содержимого виджета, он отображает <code >&lt;input type=&quot;text&quot; /&gt;</code> если мы находимся в режиме чтения-записи, и ничего, если в режиме только для чтения.</p></li><li ><p >В методе <code >display_field()</code> мы должны привязать событие <code >change</code> для <code >&lt;input type=&quot;text&quot; /&gt;</code> чтобы знать, когда пользователь изменил значение. Когда это произойдет, мы вызываем метод <code >internal_set_value()</code> с новым значением поля. Это удобный метод, предоставляемый классом <code >AbstractField</code>. Этот метод установит новое значение в свойстве <code >value</code> но не вызовет вызов <code >render_value()</code> (это необязательно, поскольку  <code >&lt;input type=&quot;text&quot; /&gt;</code> уже содержит правильное значение).</p></li><li ><p >В <code >render_value()</code> мы используем совершенно другой код для отображения значения поля в зависимости от того, находимся ли мы в режиме только для чтения или в режиме чтения-записи.</p></li></ul><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Создание цветового поля</p><p >Создайте класс <code >FieldColor</code>. Значение этого поля должно быть строкой, содержащей код цвета, подобный используемому в CSS (пример: <code >#FF0000</code> для красного цвета). В режиме только для чтения это цветовое поле должно отображать небольшой блок, цвет которого соответствует значению поля. В режиме чтения-записи вы должны отобразить <code >&lt;input type=&quot;color&quot; /&gt;</code>. Этот тип <code >&lt;input /&gt;</code> является компонентом HTML5, который работает не во всех браузерах, но хорошо работает в Google Chrome. Так что это нормально использовать в качестве упражнения.</p><p >Этот виджет можно использовать в виде формы модели данных <code >message_of_the_day</code> его поля с именем <code >color</code>. В качестве бонуса вы можете изменить виджет <code >MessageOfTheDay</code>, созданный в предыдущей части этого руководства, чтобы отобразить сообщение дня с цветом фона, указанным в поле <code >color</code>.</p></div></section><section id="the-form-view-custom-widgets"><h3 >Пользовательские виджеты для представления вида Form</h3><p >Поля представления вида Form используются для редактирования одного поля и в основном связаны с этим полем. Поскольку это может быть ограничением, также возможно создавать виджеты для <em >представления вида Form</em>, которые не являются настолько ограниченными и имеют меньше связей с конкретным жизненным циклом.</p><p >Пользовательские виджеты для представления вида Form могут быть добавлены через тег <code >widget</code>:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;widget</span> <span class="na">type=</span><span class="s">&quot;xxx&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p >Этот тип виджета будет просто создан представлением вида Form во время генерации HTML в соответствии с определением в XML описании. Они имеют общие свойства с полями (например, свойство  <code >effective_readonly</code>) но им не присвоено точное поле. И поэтому они не имеют методов, таких как  <code >get_value()</code> и <code >set_value()</code>. Они должны наследоваться от абстрактного класса <code >FormWidget</code>.</p><p >Пользовательские виджеты для представления вида Form могут взаимодействовать с полями, слушая их изменения и получая или изменяя их значения. Они могут обращаться к полям представления через атрибут <code class="js-attr xref js">field_manager</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetMultiplication</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:integer_a&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:integer_b&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_result</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;integer_a&quot;</span><span class="p">)</span> <span class="o">*</span>
                     <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;integer_b&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;a*b = &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;multiplication&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.WidgetMultiplication&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p ><code class="js-attr xref js">FormWidget</code> сам обычно является <code class="js-class xref js">FormView()</code> но используемые в нем функции должны быть ограничены функциями, определенными <code class="js-class xref js">FieldManagerMixin()</code>, наиболее полезным образом:</p><ul ><li ><p ><code class="js-func xref js">get_field_value(field_name)()</code>, которое возвращает значение поля.</p></li><li ><p ><code class="js-func xref js">set_values(values)()</code> устанавливает несколько значений поля, принимает отображение <code >{field_name: value_to_set}</code></p></li><li ><p >Событие <code class="samp">field_changed:<em >field_name</em></code> запускается каждый раз, когда изменяется значение поля с именем  <code >field_name</code>.</p></li></ul><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Показать координаты на карте Google</p><p >Добавьте два поля в <code >product.product</code>, хранящие широту и долготу, а затем создайте новый виджет формы, чтобы отобразить широту и долготу происхождения товара на карте</p><p >Чтобы отобразить карту, используйте механизм интеграции Google Map в свой сайт:</p><div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;400&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;300&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://maps.google.com/?ie=UTF8&amp;amp;ll=XXX,YYY&amp;amp;output=embed&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
<p >Где `` XXX`` следует заменить широтой и `` YYY`` - долготой.</p><p >Отобразите два поля позиции и виджет карты, используя их в новой вкладке в режиме notebook представления вида Form текущего товара.</p></div><div role="alert" class="alert-exercise alert"><h3 class="alert-title">Exercise</h3><p >Получение текущих координат</p><p >Добавьте кнопку, переустановив координаты продукта в местоположение пользователя, вы можете получить эти координаты, используя интерфейс <a href="http://diveintohtml5.info/geolocation.html" class="external reference alert-link">javascript geolocation API</a>.</p><p >Теперь мы хотим отобразить дополнительную кнопку, чтобы автоматически устанавливать координаты текущего положение пользователя.</p><p >Чтобы получить координаты пользователя, простым способом является использование JavaScript API-интерфейс. Смотрите <a href="http://www.w3schools.com/html/html5_geolocation.asp" class="external reference alert-link">See the online documentation to know how to use it</a>.</p><p >Также обратите внимание, что пользователь не должен нажимать на эту кнопку, когда вид формы находится в режиме только для чтения. Таким образом, этот пользовательский виджет должен корректно обрабатывать свойство <code >effective_readonly</code> точно так же, как любое поле. Одним из способов сделать это было бы заставить кнопку исчезать, когда значение <code >effective_readonly</code> истинно.</p></div><div class="footnote" id="id4"><span class="footnote-label"><a class="footnote-backref" href="#id1">[1]</a></span> <p >как отдельное понятие из экземпляра. Во многих языках классы являются полноценными объектами а так же сами экземпляры (метаклассов), но это два достаточно разных поняти класс и экземпляр и между ними соблюдается четко прописанная иерархия</p></div><div class="footnote" id="dombugs"><span class="footnote-label"><a class="footnote-backref" href="#id2">[2]</a></span> <p >А также с учетом различий между браузерами, хотя со временем это стало менее необходимым</p></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
  <footer class="o_footer_effect">
      <div id="footer" class="container o_not_editable">
          <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
          <div class="row">
              <div class="col-xs-12">
                  <hr/>
                  <p>Перевод документации при поддержке <a href="https://www.yartsev.by/" target="_blank">Ярцев и компаньоны</a> и <a href="https://www.udelta.ru" target="_blank">Udelta</a></p>
                  <hr/>
                  <p>
                      <small>Odoo - это набор бизнес-приложений с открытым исходным кодом, которые охватывают все потребности вашей компании: CRM, интернет магазин, бухгалтерский учет, складской учет, POS терминал, управление проектами и т.д. <br/> <br/>
                      В то же время полноценное внедрение Odoo может быть очень простым и включать полную интеграцию с вашим предприятием.</small>
                  </p>
              </div>
          </div>
      </div>
  
      <div class="o_footer_bottom o_not_editable">
          <div class="container">
              <a class="small" href="https://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
              <div class="social-links pull-right">
                  <a href="https://www.odoo.com/web/about/facebook">
                      <i class="fa fa-facebook"></i>
                  </a>
                  <a href="https://www.odoo.com/web/about/twitter">
                      <i class="fa fa-twitter"></i>
                  </a>
                  <a href="https://www.odoo.com/web/about/linkedin">
                      <i class="fa fa-linkedin"></i>
                  </a>
                  <a href="mailto:info@odoo.com">
                      <i class="fa fa-envelope"></i>
                  </a>
              </div>
          </div>
      </div>
    </footer><!-- Yandex.Metrika counter --> <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter44508703 = new Ya.Metrika({ id:44508703, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/44508703" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->
  </body>
</html>