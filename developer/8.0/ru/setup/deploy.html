<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="Русский">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>Развертывание (Deploy) &mdash; Перевод на русский язык документации Odoo 8.0</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <script type="text/javascript" src="https://yastatic.net/es5-shims/0.0.2/es5-shims.min.js"></script>
    <script type="text/javascript" src="https://yastatic.net/share2/share.js"></script>
    <link rel="top" title="Перевод на русский язык документации Odoo 8.0" href="../index.html" />
    <link rel="up" title="Настройка" href="../setup.html" />
    <link rel="next" title="Справочные материалы" href="../reference.html" />
    <link rel="prev" title="Установка" href="install.html" /> 
  </head>
  <body role="document"><header class="o_main_header o_has_sub_nav o_inverted ">
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <ul class="o_primary_nav">
        <li><a href="/">Документация</a></li>
      </ul>
    </div>
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Меню
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              
              





    
        
            <li><a href="../index.html">Документация  (8.0)</a></li>
        
    
    <li class="active"><a href="#">Развертывание (Deploy)</a></li>

              
          </ol>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
             

<li class="languages dropdown">
    <a class="dropdown-toggle" href="#" data-toggle="dropdown">
        Русский
    </a>
    <ul class="dropdown-menu" role="menu">
        
            <li><a href="/developer/8.0/en/setup/deploy.html">English</a></li>
        
    </ul>
</li>



<li class="versions dropdown">
    <a class="dropdown-toggle" href="#" data-toggle="dropdown">
        8.0
    </a>
    <ul class="dropdown-menu" role="menu">
        
            <li><a href="/developer/9.0/ru/setup/deploy.html">9.0</a></li>
        
            <li><a href="/developer/10.0/ru/setup/deploy.html">10.0</a></li>
        
            <li><a href="/developer/11.0/ru/setup/deploy.html">11.0</a></li>
        
    </ul>
</li>

            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            
              <li class="divider"></li>
            

            
            

<li><a href="/user/8.0/ru/">Пользователю</a></li>
<li><a href="/developer/8.0/ru/">Разработчику</a></li>
<li><a href="/developer/8.0/ru/api_integration.html">API</a></li>
<li><a href="/developer/8.0/ru/setup/install.html">Установка</a></li>
            

            
              <li class="divider"></li>
            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/deploying_odoo.jpg');"></span>
      <div class="container text-center">
        <h1> Развертывание (Deploy) - Odoo 8.0 </h1>
      </div>
    </figure>
    
    
    
    <div class="container ">
      <main class="container-fluid ">
        
        <div class="row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="list-group text-left nav"><li class="list-group-item"><a href="#dbfilter" class="ripple internal reference">dbfilter</a></li><li class="list-group-item"><a href="#postgresql" class="ripple internal reference">PostgreSQL</a><ul ><li class="list-group-item"><a href="#configuring-odoo" class="ripple internal reference">Настройка Odoo</a></li></ul></li><li class="list-group-item"><a href="#https" class="ripple internal reference">HTTPS</a></li><li class="list-group-item"><a href="#builtin-server" class="ripple internal reference">Встроенный сервер</a><ul ><li class="list-group-item"><a href="#livechat" class="ripple internal reference">Живой чат</a></li></ul></li><li class="list-group-item"><a href="#odoo-as-a-wsgi-application" class="ripple internal reference">Odoo как приложение WSGI</a><ul ><li class="list-group-item"><a href="#cron-workers" class="ripple internal reference">Задания Cron</a></li><li class="list-group-item"><a href="#id4" class="ripple internal reference">Живой чат</a></li></ul></li><li class="list-group-item"><a href="#serving-static-files" class="ripple internal reference">Хранение статических файлов</a></li><li class="list-group-item"><a href="#security" class="ripple internal reference">Безопасность</a><ul ><li class="list-group-item"><a href="#super-admin-password" class="ripple internal reference">Пароль &quot;супер-админа&quot;</a></li></ul></li></ul>
              
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/8.0/doc/setup/deploy.rst" class="gith-link" target="_blank">
                  Оригинал на GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            <div class="ya-share2" data-services="collections,vkontakte,facebook,odnoklassniki,moimir,gplus,twitter,linkedin,viber,whatsapp,skype,telegram"></div>
            
            
  <section id="deploying-odoo"><p >В этом документе описаны основные шаги по настройке Odoo на сервере. Их нужно делать после <a href="install.html#setup-install" class="internal reference"><span class="std std-ref">установки</span></a>. Они обычно не нужны для окружения разработки, которые не видны в интернете.</p></section><section id="dbfilter"><h2 >dbfilter</h2><p >Одна система Odoo может запускаться и обслуживать несколько экземпляров базы данных. Каждый из них имеет свои индивидуальные настройки (например установленные модули) в зависимости от базы данных, которая используется в данный момент.</p><p >Это не проблема при работе только с бэкэндом (веб-клиентом) в качестве зарегистрированного пользователя компании: при входе в систему можно выбрать базу данных и Odoo запомнит какую именно.</p><p >Однако это проблема проявляется для не зарегистрированных пользователей (портала, веб-сайта), которые не привязаны к базе данных: Odoo нужно знать, какая база данных должна использоваться для конкретных операций или для получения данных. Если используется одна база данных, то Odoo работает с ней, но если доступно несколько баз данных, то Odoo нуждается в правиле, чтобы узнать, какую из них нужно использовать.</p><p >Для этих целей используется <a href="../reference/cmdline.html#cmdoption-odoo.py--db-filter" class="internal reference"><code class="std xref std-option">--db-filter</code></a>: он указывает базу данных по умолчанию для системы Odoo. Значение представляет собой <a href="https://docs.python.org/2/library/re.html" class="external reference">регулярное выражение</a>, включая динамически введенное имя хоста или поддомен, через который осуществляется обращение к системе Odoo.</p><p >Если Odoo содержит несколько баз данных на сервере, особенно если используется <code >website</code>, он <strong >должен</strong> использовать dbfilter, или некоторые функции не будут работать корректно или вообще не будут использоваться.</p></section><section id="postgresql"><h2 >PostgreSQL</h2><p >По умолчанию PostgreSQL разрешает только подключение к UNIX-сокетам и loopback соединениям (из &quot;localhost&quot;, той же машине, на которой установлен сервер PostgreSQL).</p><p >UNIX-сокет удобен, если вы хотите, чтобы Odoo и PostgreSQL выполнялись на одном компьютере, и по умолчанию не задаются адреса компьютеров, но если вы хотите, чтобы Odoo и PostgreSQL выполнялись на разных машинах <a href="#different-machines" class="footnote-ref" id="id1">1</a>, то необходимо <a href="http://www.postgresql.org/docs/9.3/static/runtime-config-connection.html" class="external reference">listen to network interfaces</a> <a href="#remote-socket" class="footnote-ref" id="id2">2</a>, либо:</p><ul ><li ><p >только принимать соединения loopback и <a href="http://www.postgresql.org/docs/9.3/static/ssh-tunnels.html" class="external reference">use an SSH tunnel</a> между машиной, на которой работает Odoo, и тем, на котором запускается PostgreSQL, а затем настроить Odoo для подключения к туннелю</p></li><li ><p >принимать соединения с машиной, на которой установлен Odoo, возможно, поверх ssl (см. <a href="http://www.postgresql.org/docs/9.3/static/runtime-config-connection.html" class="external reference">PostgreSQL connection settings</a> для получения подробной информации), затем настройте Odoo для подключения по сети</p></li></ul></section><section id="configuring-odoo"><i id="setup-deploy-odoo"></i><h3 >Настройка Odoo</h3><p >Из коробки Odoo подключается к локальному postgres через сокет UNIX и порт 5432. Эти параметры можно переопределить, используя <a href="../reference/cmdline.html#reference-cmdline-server-database" class="internal reference"><span class="std std-ref">параметры базы данных</span></a>, если Postgres установлен не локально и/или не использует установки по умолчанию.</p><p >При <a href="install.html#setup-install-packaged" class="internal reference"><span class="std std-ref">установке с использовании инсталяторов</span></a> автоматически создаст нового пользователя (<code >odoo</code>) и установит его как пользователя базы данных.</p><ul ><li ><p >Экран управления базами данных защищен паролем, который устанавливается настройкой <code >admin_passwd</code>. Этот параметр можно установить только в файле конфигурации, и он используется перед выполнением изменений базы данных. Он должен быть произвольно сгенерированным значением, чтобы гарантировать, что из вне никто не получит доступ к вашим базам данных.</p></li><li ><p >все операции с базой данных используют <a href="../reference/cmdline.html#reference-cmdline-server-database" class="internal reference"><span class="std std-ref">параметры баз данных</span></a>, включая экран управления базой данных. Для работы экрана управления базой данных необходимо, чтобы пользователь <code >odoo</code> имел право <code >createdb</code> (создавать базы данных).</p></li><li ><p >пользователь создавший базу данных имеет право ее удалить. Чтобы этого нельзя было сделать через экран управления базами данных, пользователь <code >odoo</code> должен быть создан с правами <code >no-createdb</code>, а база данных должна принадлежать другому пользователю.</p><div role="alert" class="alert-warning alert"><p class="alert-title">Предупреждение</p><p >пользователь <code >odoo</code> <em >не должен</em> быть суперпользователем</p></div></li></ul></section><section id="https"><h2 >HTTPS</h2><p >Независимо от того, используете ли вы Odoo как веб-сайт, или как веб-клиент, или как веб-сервис, Для безопасной передачи информацию аутентификации нужно использоваться HTTPS[#switching] _. SSL может быть реализован с помощью любого прокси-сервера, но для этого потребуются следующие настройки:</p><ul ><li ><p >включить Odoo's <a href="../reference/cmdline.html#cmdoption-odoo.py--proxy-mode" class="internal reference"><code class="std xref std-option">proxy mode</code></a>. Это настройка нужна тогда, когда Odoo находится за обратным прокси-сервером</p></li><li ><p >настроить прокси-сервер для работы по SSL (<a href="http://nginx.com/resources/admin-guide/nginx-ssl-termination/" class="external reference">Nginx termination example</a>)</p></li><li ><p >настроить прокси сервер (<a href="http://nginx.com/resources/admin-guide/reverse-proxy/" class="external reference">Nginx proxying example</a>)</p></li><li ><p >ваш прокси-сервер должен автоматически перенаправлять незащищенные обращения на защищенный порт</p></li></ul></section><section id="builtin-server"><h2 >Встроенный сервер</h2><p >Odoo включает в себя встроенный HTTP-сервер, который использует многопоточность и многопроцессорность.</p><p >Для использования на продакшене рекомендуется использовать многопроцессорность на сервере, поскольку это повышает стабильность, улучшает использование вычислительных ресурсов и может быть лучше контролироваться.</p><ul ><li ><p >Многопроцессорность включается путем настройки <a href="../reference/cmdline.html#cmdoption-odoo.py--workers" class="internal reference"><code class="std xref std-option">ненулевое число рабочих процессов</code></a>, количество workers должно быть равно количеству ядер процессора (возможно, в некоторых случаях стоит учесть сколько ядер процессора выделено для Cron)</p></li><li ><p >Ограничения Worker настраиваются основываясь на конфигурации оборудования, чтобы избежать исчерпания ресурсов</p></li></ul><div role="alert" class="alert-warning alert"><p class="alert-title">Предупреждение</p><p >многопроцессорный режим в настоящее время недоступен в Windows</p></div></section><section id="livechat"><h3 >Живой чат</h3><p >При многопроцессорной работе автоматически запускается выделенный LiveChat worker и слушает <a href="../reference/cmdline.html#cmdoption-odoo.py--longpolling-port" class="internal reference"><code class="std xref std-option">порт longpolling</code></a>, но клиент не подключается к нему.</p><p >Вместо этого у вас должны быть перенаправленные прокси-запросы, URL которых начинается с <code >/longpolling/</code> на порт longpolling. Остальные запросы должен быть проксирован на <a href="../reference/cmdline.html#cmdoption-odoo.py--xmlrpc-port" class="internal reference"><code class="std xref std-option">обычный HTTP порт</code></a></p><div role="alert" class="alert-warning alert"><p class="alert-title">Предупреждение</p><p >Worker, который обслуживает живой чат для своей работы требует установленный модуль <code >psycogreen</code> для Python, который не всегда входит в стандартную поставку вашей системы. Вы можете установить его вручную с помощью команды <code >pip install psycogreen</code>.</p></div></section><section id="odoo-as-a-wsgi-application"><h2 >Odoo как приложение WSGI</h2><p >Также возможно установить Odoo в качестве стандартного приложения <a href="http://wsgi.readthedocs.org/" class="external reference">WSGI</a>. Odoo предоставляет базу для сценария запуска WSGI - <code >openerp-wsgi.py</code>. Этот скрипт должен быть настроен (возможно, после его копирования из каталога установки), чтобы правильно настроить конфигурацию непосредственно в  <code class="py xref py-mod">openerp.tools.config</code>, а не через командную строку или файл конфигурации.</p><p >Сервер WSGI будет работать для веб-клиента, веб-сайта и API веб-сервиса, но  Odoo не будет контролировать создание workers, он не сможет настроить workers cron или livechat workers</p></section><section id="cron-workers"><h3 >Задания Cron</h3><p >Для выполнения заданий cron при развертывании Odoo в качестве приложения WSGI требуется</p><ul ><li ><p >классический Odoo (запускается как <code >odoo.py</code>)</p></li><li ><p >подключение к базе данных, в которой должны выполняться задания cron (через <a href="../reference/cmdline.html#cmdoption-odoo.py-d" class="internal reference"><code class="std xref std-option">odoo.py -d</code></a>)</p></li><li ><p >если нужно обеспечить, чтобы задания cron не были доступны для сети, можно полностью отключить встроенный HTTP-сервер с помощью опции <a href="../reference/cmdline.html#cmdoption-odoo.py--no-xmlrpc" class="internal reference"><code class="std xref std-option">odoo.py --no-xmlrpc</code></a> или настройкой  <code >xmlrpc = False</code> в файле конфигурации.</p></li></ul></section><section id="id4"><h3 >Живой чат</h3><p >Второй проблемной подсистемой при развертывании Odoo, как приложения WSGI, является LiveChat: где большинство HTTP-соединений относительно короткие и быстро освобождают рабочий процесс для следующего запроса, LiveChat требует долговременного подключения для каждого клиента, чтобы внедрять уведомления в режиме реального времени.</p><p >Это противоречит рабочей модели, основанной на процессах, поскольку она свяжет рабочие процессы и предотвращает доступ новых пользователей к системе. Тем не менее, эти долгоживущие соединения делают очень мало и в основном выполняют функцию ожидания уведомлений.</p><p >Решения для поддержки живого чата и уведомлений в приложении WSGI:</p><ul ><li >deploy a threaded version of Odoo (instread of a process-based preforking
one) and redirect only requests to URLs starting with <code >/longpolling/</code> to
that Odoo, this is the simplest and the longpolling URL can double up as
the cron instance.</li><li >deploy an evented Odoo via <code >openerp-gevent</code> and proxy requests starting
with <code >/longpolling/</code> to
<a href="../reference/cmdline.html#cmdoption-odoo.py--longpolling-port" class="internal reference"><code class="std xref std-option">the longpolling port</code></a>.</li></ul></section><section id="serving-static-files"><h2 >Хранение статических файлов</h2><p >Для удобства разработки Odoo хранит все статические файлы в своих модулях. Это не идеально с точки зрения производительности. Статические файлы обычно должны обслуживаться HTTP-сервером.</p><p >Статические файлы Odoo живут в папке <code >static/</code> каждого модуля, поэтому статические файлы могут отдаваться веб-сервером путем перехвата всех запросов <code class="samp">/<em >MODULE</em>/static/<em >FILE</em></code> и поиска правильного модуля (и файла) по всем путям хранения аддонов.</p></section><section id="security"><h2 >Безопасность</h2></section><section id="super-admin-password"><h3 >Пароль &quot;супер-админа&quot;</h3><p ><code >admin_passwd</code> мимоходом упоминается в <a href="#setup-deploy-odoo" class="internal reference"><span class="std std-ref">Настройка Odoo</span></a></p><p >Этот параметр используется для всех действий над базами данных (для создания, удаления, сброса или восстановления баз данных).</p><p >Если экраны управления не должны быть доступны или должны быть доступны только из выбранного набора компьютеров, используйте функции прокси-сервера для блокировки доступа ко всем адресам, начинающимся с <code >/web/database</code>, за исключением (возможно) <code >/web/database/selector</code>, который отображает экран выбора базы данных.</p><p >Если экран управления базой данных должен быть доступен, параметр <code >admin_passwd` должен быть изменен с ``admin</code> по умолчанию: этот пароль проверяется перед тем, как совершить операцию изменения базы данных.</p><p >Он должен храниться надежно и должен генерироваться случайным образом, например</p><div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> python -c <span class="s1">&#39;import base64, os; print(base64.b64encode(os.urandom(24)))&#39;</span>
</pre></div>
</div>
<p >этот код выведет 32-символьную псевдослучайную строку.</p><div class="footnote" id="different-machines"><span class="footnote-label"><a class="footnote-backref" href="#id1">[1]</a></span> <p >чтобы несколько установок Odoo использовали одну и ту же базу данных PostgreSQL или обеспечивали больше вычислительных ресурсов для обоих программ.</p></div><div class="footnote" id="remote-socket"><span class="footnote-label"><a class="footnote-backref" href="#id2">[2]</a></span> <p >технически такой инструмент, как <a href="http://www.dest-unreach.org/socat/" class="external reference">socat</a>, может использоваться для прокси UNIX-сокетов по сетям, но это в основном для программного обеспечения, которое можно использовать только для UNIX сокетов</p></div><div class="footnote" id="switching"><span class="footnote-label"><a class="footnote-backref" href="#id3">[3]</a></span> <p >или быть доступным только через внутреннюю сеть с коммутацией пакетов, но для этого требуются защищенные коммутаторы, с защитой от [UNKNOWN NODE title_reference] и отключенным Wi-Fi. Даже над защищенными сетями с коммутацией пакетов рекомендуется развертывание по HTTPS, а возможные затраты снижаются, поскольку «самоподписанные» сертификаты легче развертывать в контролируемой среде, чем в Интернете.</p></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
    </div>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
  <footer class="o_footer_effect">
            <div id="footer" class="container o_not_editable">
                <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
                <div class="row">
                    <div class="col-xs-12">
                        <hr>
						<p>Перевод документации при поддержке <a href="https://www.yartsev.by/" target="_blank">Ярцев и компаньоны</a> и <a href="https://www.udelta.ru" target="_blank">Udelta</a></p>
                        <hr>
                        <p>
                            <small>Odoo - это набор бизнес-приложений с открытым исходным кодом, которые охватывают все потребности вашей компании: CRM, интернет магазин, бухгалтерский учет, складской учет, POS терминал, управление проектами и т.д. <br> <br>
В то же время полноценное внедрение Odoo может быть очень простым и включать полную интеграцию с вашим предприятием.</small>
                        </p>
                    </div>
                </div>
            </div>

            <div class="o_footer_bottom o_not_editable">
                <div class="container">
                    <a class="small" href="https://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
                    <div class="social-links pull-right">
                        <a href="https://www.odoo.com/web/about/facebook">
                            <i class="fa fa-facebook"></i>
                        </a>
                        <a href="https://www.odoo.com/web/about/twitter">
                            <i class="fa fa-twitter"></i>
                        </a>
                        <a href="https://www.odoo.com/web/about/linkedin">
                            <i class="fa fa-linkedin"></i>
                        </a>
                        <a href="mailto:info@odoo.com">
                            <i class="fa fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer><!-- Yandex.Metrika counter --> <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter44508703 = new Ya.Metrika({ id:44508703, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/44508703" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->
  </body>
</html>